import { useEffect, useState } from "react";
import styled, { keyframes } from "styled-components";
import { RootState } from "../../store/configureStore";
import { useSelector } from "react-redux";

interface OverlayProps {
  $isDarkMode: boolean;
}

const Container = styled.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 99999;
`;

const Overlay = styled.div<OverlayProps>`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #2f3640;
  transform: scaleY(0);
  transition: all 1.2s cubic-bezier(0.55, 0.02, 0.1, 0.9);
  transform-origin: top center;
  transition-delay: 2s;
  border-bottom: 4px solid #ff6b00;

  ${Container}.active & {
    transform: scaleY(1);
  }
`;

const LogoContainer = styled.div`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  position: absolute;
  left: 50%;
  width: 600px;
  transform: translate(-50%, -150%);
  top: 0;
  opacity: 0;
  transition: all 1.6s cubic-bezier(0.55, 0.02, 0.1, 0.9);
  transition-delay: 1.6s;

  ${Container}.active & {
    top: 50%;
    transform: translate(-50%, -50%);
    opacity: 1;
  }
`;

const fillAnimation = keyframes`
 0% {
    fill: transparent;
  }

  100% {
    fill: rgb(0, 0, 0);
  }
`;

const strokeAnimation1 = keyframes`
  0% {
    stroke-dashoffset: 1628px;
    stroke-dasharray: 1628px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 1628px;
  }
`;

const strokeAnimation2 = keyframes`
  0% {
    stroke-dashoffset: 1004px;
    stroke-dasharray: 1004px;
  }
  
  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 1004px;
  }
`;

const strokeAnimation3 = keyframes`
  0% {
    stroke-dashoffset: 447px;
    stroke-dasharray: 447px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 447px;
  }
`;

const strokeAnimation4 = keyframes`
  0% {
    stroke-dashoffset: 447px;
    stroke-dasharray: 447px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 447px;
  }
`;

const strokeAnimation5 = keyframes`
  0% {
    stroke-dashoffset: 393px;
    stroke-dasharray: 393px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 393px;
  }
`;

const strokeAnimation6 = keyframes`
  0% {
    stroke-dashoffset: 370px;
    stroke-dasharray: 370px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 370px;
  }
`;

const strokeAnimation7 = keyframes`
  0% {
    stroke-dashoffset: 200px;
    stroke-dasharray: 200px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 200px;
  }
`;

const strokeAnimation8 = keyframes`
  0% {
    stroke-dashoffset: 76px;
    stroke-dasharray: 76px;
  }

  100% {
    stroke-dashoffset: 0;
    stroke-dasharray: 76px;
  }
`;

const SVG = styled.svg`
  width: 620px;
  height: 450px;

  @media (max-width: 767px) {
    width: 450px;
    height: 220px;
  }

  .svg-elem-1 {
    animation: ${strokeAnimation1} 2.5s cubic-bezier(0.47, 0, 0.745, 0.715) 0s
        both,
      ${fillAnimation} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715) 0.8s both;
  }

  .svg-elem-2 {
    animation: ${strokeAnimation2} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715)
        0.12s both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 0.9s both;
  }

  .svg-elem-3 {
    animation: ${strokeAnimation3} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715)
        0.24s both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 1s both;
  }

  .svg-elem-4 {
    animation: ${strokeAnimation4} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715)
        0.36s both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 1.1s both;
  }

  .svg-elem-5 {
    animation: ${strokeAnimation5} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715)
        0.48s both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 1.2s both;
  }

  .svg-elem-6 {
    animation: ${strokeAnimation6} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715) 0.6s
        both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 1.3s both;
  }

  .svg-elem-7 {
    animation: ${strokeAnimation7} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715)
        0.72s both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 1.4s both;
  }

  .svg-elem-8 {
    animation: ${strokeAnimation8} 1.5s cubic-bezier(0.47, 0, 0.745, 0.715)
        0.84s both,
      ${fillAnimation} 0.7s cubic-bezier(0.47, 0, 0.745, 0.715) 1.5s both;
  }
`;

const Loading = () => {
  const [isActive, setIsActive] = useState<boolean>(true);
  const [isMounted, setIsMounted] = useState<boolean>(true);
  const isDarkMode = useSelector((state: RootState) => state.theme.isDarkMode);

  useEffect(() => {
    const timer = setTimeout(() => {
      setIsActive(false);
    }, 1500);

    return () => clearTimeout(timer);
  }, []);

  useEffect(() => {
    const timer2 = setTimeout(() => {
      setIsMounted(false);
    }, 4500);

    return () => clearTimeout(timer2);
  }, []);

  if (!isMounted) {
    return null;
  }

  return (
    <Container id="loading" className={isActive ? "active" : ""}>
      <Overlay $isDarkMode={isDarkMode} />
      <LogoContainer className={isActive ? "active" : ""}>
        <SVG
          stroke="#FF6B00"
          strokeWidth="1px"
          fill="#000"
          viewBox="0 0 624 450"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clipPath="url(#clip0_385_33)">
            <path
              d="M254.882 84.5561C254.519 81.5018 253.436 78.6659 251.802 76.2258L398.131 27.3687L390.45 4.3617C389.334 1.01834 385.717 -0.785972 382.376 0.3292L223.202 53.4747C219.861 54.5899 218.053 58.2057 219.17 61.5491L222.936 72.8284C219.176 76.3195 216.817 81.2999 216.817 86.8239C216.817 93.9777 220.772 100.222 226.608 103.495V193.617C226.608 197.143 229.468 199.999 232.991 199.999H400.802C404.323 199.999 407.183 197.142 407.183 193.617V84.5561H254.882ZM348.148 19.2641L367.521 12.7958L362.859 31.6391L343.486 38.1074L348.148 19.2641ZM300.284 35.2448L319.658 28.7765L314.996 47.6191L295.623 54.0881L300.284 35.2448ZM235.919 96.5562C230.554 96.5562 226.189 92.1907 226.189 86.8246C226.189 81.4585 230.554 77.093 235.919 77.093C241.285 77.093 245.65 81.4585 245.65 86.8246C245.65 92.1907 241.285 96.5562 235.919 96.5562ZM252.421 51.2256L271.796 44.7573L267.134 63.6006L247.76 70.0696L252.421 51.2256ZM271.454 106.105H251.029L261.418 89.708H281.843L271.454 106.105ZM311.878 89.708H332.303L321.914 106.105H301.489L311.878 89.708ZM306.864 168.949V125.698L341.309 147.324L306.864 168.949ZM372.374 106.105H351.949L362.338 89.708H382.763L372.374 106.105Z"
              className="svg-elem-1"
            ></path>
          </g>
          <path
            d="M151.734 225.062H157.219L163.617 226.198L167.578 227.334L171.539 229.378L173.367 230.968L174.281 232.558L174.586 233.92V238.236L174.281 242.779L177.023 251.41L180.984 263.447L186.469 283.208L190.125 298.88L193.172 314.325L196.828 335.902L200.18 358.615L202.922 377.694L205.055 390.641L205.664 393.139V397L204.141 399.272L202.008 400.18L200.789 400.407H195.609L186.773 398.817L183.117 397.682L180.68 395.865L179.461 392.912L178.242 384.054L175.5 361.341L172.453 337.265L170.32 322.956L167.883 308.647L165.445 295.473L165.141 294.564L161.484 313.189L159.047 325.681L156.914 337.492L156 344.533L155.391 349.53L153.562 356.117L151.43 361.795L149.602 365.202L147.469 367.473L145.336 368.836L141.984 369.745L137.719 369.972L134.367 369.518L131.016 368.155L127.359 365.429L124.922 362.249L122.484 358.388L117.914 349.53L112.125 336.811L106.945 324.546L102.68 314.098L99.0234 304.558L98.4141 303.195L99.6328 321.139L101.156 339.082L102.68 352.71L104.812 367.928L106.945 379.966L108.164 385.19L109.688 391.095L109.992 394.956L109.078 396.546L107.859 397.682L104.812 398.59L101.156 399.045H95.9766L91.1016 398.136L87.4453 396.773L85.9219 395.865L83.7891 393.593L82.5703 391.322L81.6562 387.234L80.1328 370.199L77.3906 346.35L76.1719 332.041L75.5625 321.593L74.6484 299.334L73.7344 266.4L73.4297 245.958L73.7344 237.1L74.6484 234.829L76.1719 233.693L77.3906 233.239H84.0938L88.0547 234.148L90.7969 235.51L92.9297 237.1L99.0234 246.186L102.68 253.227L107.859 264.583L112.734 276.167L120.047 294.792L127.359 313.871L131.625 324.773L134.062 330.224L134.977 325.454L143.508 274.577L147.773 247.094L148.688 241.87V235.056L147.164 230.741L146.859 227.788L147.773 226.425L148.688 225.744L151.734 225.062Z"
            className="svg-elem-2"
          ></path>
          <path
            d="M251.977 297.517H257.156L259.594 298.199L261.117 299.561L261.727 301.606L267.211 302.968L270.258 304.104L273 305.694L276.047 307.965L279.094 311.145L282.141 315.233L284.883 320.23L287.32 326.363L289.148 334.54L290.062 342.035V352.483L289.453 359.07L288.234 366.792L286.406 372.925L283.664 378.83L280.008 384.508L276.961 388.142L274.219 390.868L271.477 393.139L268.734 395.183L263.859 397.682L259.289 399.272L255.633 399.953H247.711L243.141 399.045L239.18 397.455L236.133 395.638L234.305 394.502L232.172 392.685L229.125 389.505L225.469 384.281L223.641 380.874L221.203 374.742L219.375 368.155L218.156 361.114L217.547 354.981V347.032L218.461 337.492L219.984 329.997L221.508 325L224.25 318.413L227.297 313.189L230.648 309.101L233.695 306.148L236.438 303.877L239.484 301.833L244.969 299.334L249.539 297.971L251.977 297.517ZM248.016 315.233L245.273 319.095L242.227 325.454L240.703 329.997L239.484 335.902L238.875 340.445L238.57 345.896V350.212L239.18 358.161L240.398 365.656L241.922 371.335L243.75 376.332L246.188 380.874L248.32 383.827L251.672 386.552L253.195 386.325L256.242 384.281L258.68 382.01L261.117 378.603L263.555 373.833L265.078 369.745L266.602 364.294L267.516 358.843L267.82 355.436V344.988L266.906 337.946L265.383 330.678L263.555 325.227L260.812 320.003L258.68 317.505L257.461 316.369L256.547 316.142L255.633 316.369H253.195L250.148 315.915L248.93 315.233H248.016Z"
            className="svg-elem-3"
          ></path>
          <path
            d="M333.938 297.063H338.812L341.859 297.971L343.078 299.561L343.688 301.378L348.562 302.514L351.609 303.65L354.352 305.24L357.398 307.511L360.75 311.145L363.797 315.46L365.93 319.776L368.367 326.363L369.891 333.631L370.5 338.855L370.805 343.17V347.486L370.195 355.663L368.977 363.385L367.148 370.426L365.32 374.742L363.492 378.376L359.531 384.508L356.484 387.915L354.047 390.187L350.695 392.912L348.562 394.502L344.297 396.773L339.117 398.59L336.07 399.272L333.938 399.499H328.453L323.578 398.59L319.922 397.455L316.266 395.411L313.219 393.366L310.781 391.095L307.43 387.007L305.602 384.281L303.164 379.511L301.336 374.742L299.508 367.701L298.289 359.297L297.984 355.663V348.394L298.898 338.855L300.422 331.132L302.25 325.227L304.688 319.322L306.516 315.915L308.953 312.054L312.609 307.738L315.961 304.785L317.484 303.423L320.836 301.378L325.102 299.334L329.367 297.971L333.938 297.063ZM329.672 314.552L327.844 316.823L325.102 321.139L322.359 327.271L320.836 332.722L319.617 339.536L319.312 342.716V356.117L320.227 363.612L321.75 370.426L323.578 375.877L326.016 380.647L328.148 383.373L330.891 385.644L332.109 386.098L334.852 384.508L337.898 382.01L340.336 378.83L343.078 374.287L345.516 368.155L346.734 363.612L347.953 357.025L348.562 349.53L348.258 342.035L347.039 333.404L345.82 328.18L344.602 324.773L342.469 320.23L340.336 317.278L338.508 315.688H332.414L330.586 314.779L329.672 314.552Z"
            className="svg-elem-4"
          ></path>
          <path
            d="M421.992 287.978H428.391L433.266 288.659L436.312 289.795L438.75 291.385L440.273 293.202L441.492 296.154L441.797 298.88V311.599L441.188 320.457L439.969 329.088L438.445 337.492L436.312 346.123L432.961 358.615L428.391 373.379L425.344 382.691L423.211 387.461L421.078 390.414L418.641 392.685L416.508 394.275L413.461 395.638L410.719 396.319H406.758L402.492 395.183L399.141 393.366L397.008 391.322L395.484 388.824L393.656 384.735L391.219 377.013L389.086 368.609L385.734 352.256L382.992 337.038L381.469 330.678L377.508 317.732L375.68 311.145L375.375 309.555V307.738L376.289 306.148L377.812 305.24L379.641 304.785H385.43L389.391 305.694L392.742 307.284L394.875 309.101L396.703 312.054L398.227 316.369L400.359 324.319L402.188 330.224L404.93 340.445L408.281 355.663L409.195 360.432V362.249H409.805L411.023 357.025L413.766 347.032L416.203 336.357L417.727 327.271L418.336 322.502L418.641 318.413V308.192L417.117 297.063V290.93L418.031 289.568L419.25 288.659L421.992 287.978Z"
            className="svg-elem-5"
          ></path>
          <path
            d="M523.148 304.785L527.414 305.013L530.766 305.694L533.508 306.602L536.859 308.192L539.602 310.237L542.344 313.416L543.867 316.142L545.086 320.003V325.681L543.867 329.543L541.43 334.085L538.078 338.855L533.203 344.306L528.938 348.167L522.539 352.937L517.359 355.89L511.57 358.388L512.484 364.975L514.008 371.108L515.836 375.877L517.969 379.739L519.797 381.783L521.93 382.691L524.062 382.918L526.5 382.01L528.328 380.42L533.203 373.152L535.945 369.745L538.992 367.701L541.125 367.474L543.867 367.928L547.219 369.518L550.266 371.789L552.094 374.515L552.398 375.196V377.694L551.18 381.101L549.047 384.281L546 387.461L542.344 390.414L537.773 393.139L531.984 395.411L527.109 396.546L525.281 396.773H519.492L514.312 396.092L509.438 394.502L505.477 392.458L501.82 389.959L498.773 386.78L495.727 382.691L493.594 378.603L491.766 373.606L490.242 367.246L489.328 359.978V349.53L490.547 340.899L492.375 333.404L494.812 326.817L498.164 320.685L500.602 316.823L504.258 312.735L507 310.464L509.438 308.647L513.703 306.602L517.359 305.467L519.797 305.013L523.148 304.785ZM523.453 319.095L521.32 320.912L517.664 325.681L515.836 329.543L514.008 334.54L512.789 339.082V339.991L514.008 339.536L517.664 335.902L521.016 331.814L522.844 328.634L524.062 325.227L524.367 321.82L524.062 319.549L523.453 319.095Z"
            className="svg-elem-6"
          ></path>
          <path
            d="M458.859 310.691H463.125L466.781 311.372L469.219 312.735L471.352 314.552L473.18 317.505L474.094 320.457L474.398 322.502L474.703 328.634L475.008 366.792L475.312 374.06L476.531 387.461V390.868L475.922 392.912L474.094 394.729L472.266 395.183H467.695L462.82 394.275L457.945 392.458L455.203 390.868L453.984 389.278L453.375 386.78L453.07 383.6V355.436L453.984 332.041L454.594 318.64L454.898 314.325L455.812 312.508L457.031 311.372L458.859 310.691Z"
            className="svg-elem-7"
          ></path>
          <path
            d="M458.25 279.12H462.82L467.391 280.028L472.266 281.845L474.094 283.435L474.703 284.571V297.29L473.789 298.88L472.57 299.789L471.352 300.016H466.781L460.688 299.107L456.117 297.971L453.07 296.609L451.852 295.473L451.547 295.019L451.852 292.066L453.984 285.025L455.508 280.71L457.031 279.574L458.25 279.12Z"
            className="svg-elem-8"
          ></path>
        </SVG>
      </LogoContainer>
    </Container>
  );
};

export default Loading;
